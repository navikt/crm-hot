 #!/bin/bash

# Oppretter scratch org
sfdx force:org:create -f config/project-scratch-def.json --setalias $1 --durationdays $2 --setdefaultusername --json --loglevel fatal  --wait 10

# Installer crm-platform-base ver. 0.152
sfdx force:package:install --package 04t7U000000Tp27QAC -r -k $3 --wait 10 --publishwait 10

# Installer crm-platform-integration ver. 0.78
sfdx force:package:install --package 04t7U000000Tp4DQAS -r -k $3 --wait 10 --publishwait 10

# Installer crm-platform-access-control ver. 0.90
sfdx force:package:install --package 04t7U000000Tp3jQAC -r -k $3 --wait 10 --publishwait 10

# Installer crm-community-base ver. 0.62
sfdx force:package:install --package 04t7U000000Tos2QAC -r -k $3 --wait 10 --publishwait 10

# Installer crm-platform-reporting ver. 0.25
sfdx force:package:install --package 04t2o000000ySIYAA2 -r -k $3 --wait 10 --publishwait 10

# crm-journal-utilities ver. 0.14
sfdx force:package:install --package 04t7U000000Tn6gQAC -r -k $3 --wait 10 --publishwait 10  

# crm-shared-user-notification ver. 0.15
sfdx force:package:install --package 04t2o000000yUGyAAM -r -k $3 --wait 10 --publishwait 10  

#crm-shared-flowComponents ver. 0.2
sfdx force:package:install --package 04t2o000000yUEnAAM -r -k $3 --wait 10 --publishwait 10

# Installer crm-henvendelse ver. 0.55
sfdx force:package:install --package 04t7U000000Tp0kQAC -r -k $3 --wait 10 --publishwait 10

# Dytt kildekoden til scratch org'en
sfdx force:source:push

# Tildel tilatelsessett til brukeren
sfdx force:user:permset:assign --permsetname HOT_admin

# Opprett testdata
sfdx force:apex:execute -f scripts/apex/createTestData.apex

# done