<template>
    <div class="main-content">
        <div class="right-content">
            <lightning-button
                title="Meld interesse"
                class="right-button"
                variant="brand"
                label="Meld interesse"
                onclick={sendInterest}
            >
            </lightning-button>
            <div style="display: flex; flex-direction: row">
                <lightning-button
                    if:false={isRequestNumberNull}
                    label="Vis alle"
                    name="filterRegionButton"
                    onclick={handleBackToFullList}
                >
                </lightning-button>
                <lightning-button
                    if:true={isRequestNumberNull}
                    label="Regioner"
                    name="filterRegionButton"
                    onclick={handleShowRegionFilter}
                >
                </lightning-button>
                <lightning-input
                    if:true={isRequestNumberNull}
                    type="checkbox"
                    label="Vis alle Skjermtolk-oppdrag"
                    style="margin-left: 1rem"
                    name="Skjermtolk"
                    onchange={handleScreenInterpreter}
                >
                </lightning-input>
            </div>
            <div
                if:true={showRegionFilter}
                class="ReactModal__Overlay ReactModal__Overlay--after-open modal__overlay"
                style="z-index: 9999; background-color: rgba(50, 65, 79, 0.8)"
            >
                <div
                    class="ReactModal__Content ReactModal__Content--after-open navno-dekorator comments-dialog-container"
                    tabindex="-1"
                    role="dialog"
                    aria-labelledby="regions-header-id"
                >
                    <section>
                        <h2 id="regions-header-id" class="typo-undertittel">Regioner</h2>
                        <lightning-record-edit-form
                            class="no-padding"
                            object-api-name="ServiceResource"
                            density="comfy"
                            onsubmit={handleSubmit}
                            record-id={serviceResource.Id}
                        >
                            <lightning-input-field field-name="HOT_PreferredRegions__c"> </lightning-input-field>
                            <br />
                            <lightning-button title="Lagre" variant="brand" label="Lagre" type="submit">
                            </lightning-button>
                        </lightning-record-edit-form>
                    </section>
                    <button
                        class="lukknapp lukknapp--overstHjorne modal__lukkknapp--shake"
                        onclick={handleHideRegionFilter}
                    >
                        <span class="text-hide">Lukk</span>
                    </button>
                </div>
            </div>

            <lightning-combobox
                class="mobile-only"
                name="mobileSorting"
                label="Sorter etter"
                value={mobileSortingDefaultValue}
                options={sortingOptions}
                onchange={handleMobileSorting}
            >
            </lightning-combobox>
        </div>
        <lightning-datatable
            key-field="AppointmentNumber"
            data={allServiceAppointmentsFiltered}
            columns={columns}
            default-sort-direction={defaultSortDirection}
            sorted-direction={sortDirection}
            sorted-by={sortedBy}
            onsort={onHandleSort}
            onrowaction={handleRowAction}
            onrowselection={getSelectedName}
        >
        </lightning-datatable>

        <div class="right-content" style="margin-top: 1rem">
            <lightning-button
                title="Meld interesse"
                class="right-button"
                variant="brand"
                label="Meld interesse"
                onclick={sendInterest}
            >
            </lightning-button>
        </div>
    </div>

    <div
        class="ReactModal__Overlay ReactModal__Overlay--after-open modal__overlay commentPage hidden"
        style="z-index: 9999; background-color: rgba(50, 65, 79, 0.8)"
        tabindex="-1"
        aria-label="Legg inn kommentarer til oppdragene"
    >
        <div
            class="ReactModal__Content ReactModal__Content--after-open navno-dekorator comments-dialog-container"
            role="dialog"
            aria-labelledby="comment-header-id"
        >
            <section>
                <div>
                    <h2 id="comment-header-id" class="typo-undertittel">Legg til kommentarer til oppdragene</h2>

                    <template iterator:it={serviceAppointmentCommentDetails}>
                        <lightning-record-edit-form
                            class="comment-form"
                            key={it.value.Id}
                            object-api-name="HOT_InterestedResource__c"
                            density="comfy"
                        >
                            <c-hot_record-details record={it.value}></c-hot_record-details>
                            <lightning-input-field class="ikke-sensitive-opplysninger" field-name="Comments__c">
                            </lightning-input-field>
                        </lightning-record-edit-form>
                    </template>

                    <lightning-button
                        class="slds-m-left_x-small"
                        variant="brand"
                        type="submit"
                        label="Send inn"
                        onclick={confirmSendingInterest}
                    >
                    </lightning-button>
                </div>
            </section>
            <button class="lukknapp lukknapp--overstHjorne modal__lukkknapp--shake" onclick={abortSendingInterest}>
                <span class="text-hide">Lukk</span>
            </button>
        </div>
    </div>

    <div
        class="ReactModal__Overlay ReactModal__Overlay--after-open modal__overlay detailPage hidden"
        style="z-index: 9999; background-color: rgba(50, 65, 79, 0.8)"
        tabindex="-1"
    >
        <div
            class="ReactModal__Content ReactModal__Content--after-open navno-dekorator comments-dialog-container"
            role="dialog"
            aria-labelledby="details-header-id"
        >
            <section>
                <h2 id="details-header-id" class="typo-undertittel">Detaljer</h2>
                <c-hot_record-details record={serviceAppointmentDetails}></c-hot_record-details>
            </section>
            <button class="lukknapp lukknapp--overstHjorne modal__lukkknapp--shake" onclick={abortShowDetails}>
                <span class="text-hide">Lukk</span>
            </button>
        </div>
    </div>
</template>
