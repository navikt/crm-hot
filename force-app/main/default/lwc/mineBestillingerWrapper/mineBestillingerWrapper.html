<template>
    <div class="brodsmulesti">
        <c-breadcrumbs url-list={breadcrumbs} class="skjema-max-width"></c-breadcrumbs>
    </div>

    <main class="mainContent">
        <div class="mine-bestillinger-wrapper">
            <div class="navigation-container">
                <a if:false={isMobile} class="back-link" onclick={goBack}
                    ><c-icon icon="Back"></c-icon>
                    <p style="margin-left: 0.25rem">Tilbake</p></a
                >
                <h2 class="header">{headerToShow}</h2>
                <div class="header-buttons">
                    <c-button
                        if:false={urlStateParameters.id}
                        button-label={buttonText}
                        button-styling="primary"
                        class="button-padding mobile-button"
                        desktop-style="width: 7em; height: 3em; justify-content: center"
                        mobile-style="border-radius: 50%; justify-content: center; border-radius: 50%; 
                        justify-content: center; height: 15vw; font-size: 12vw; width: 15vw; 
                        box-shadow: 0px 5px 10px 0px rgb(0 0 0 / 30%); background-color: forestgreen;"
                        onbuttonclick={goToNewRequest}
                    ></c-button>
                    <a if:true={isMobile} class="back-link" onclick={goBack}>
                        <c-icon icon="Back"></c-icon>
                        <p style="margin-left: 0.25rem">Tilbake</p></a
                    >
                    <c-list-filters-button
                        if:false={isWorkOrderDetails}
                        header="Filtrer søket"
                        filters={filters}
                        onapplyfilter={applyFilter}
                        ongetfilteredrecordslength={sendFilteredRecordsLength}
                    ></c-list-filters-button>
                </div>
            </div>
            <div if:true={isRequestDetails}>
                <div class="record-details-container">
                    <p>Gjelder periode: <span>{requestSeriesStartDate} - {requestSeriesEndDate}</span></p>
                    <br/>
                    <p>Adresse: <span>{requestAddressToShow}</span></p>
                    <p if:true={requestInterpretationAddressToShow}>
                        Oppmøteadresse: <span>{requestInterpretationAddressToShow}</span>
                    </p>
                    <br />
                    <p if:true={request.OwnerName__c}>
                        Sentral: <span>{request.OwnerName__c}</span>
                    </p>
                    <p>Bestillingsnummer: <span>{request.Name}</span></p>
                    <p if:true={request.OrdererName__c}>
                        Bestiller: <span>{request.OrdererName__c}</span>
                    </p>
                    <p if:true={request.UserName__c}>
                        Tolkebrukers navn: <span>{request.UserName__c}</span>
                    </p>
                    <p>SMS-varsel ved statusendring på bestillingen: <span>{isOrdererWantStatusUpdateOnSMS}</span></p>
                    <br/>
                    <p if:true={request.UserPreferredInterpreter__c}>
                        Ønsket tolk: <span>{request.UserPreferredInterpreter__c}</span>
                    </p>
                    <p if:true={request.UserInterpretationMethod__c}>
                        Foretrukket tolkemetode: <span>{request.UserInterpretationMethod__c}</span>
                    </p>
                    <p if:true={request.InterpretationMethodName__c}>
                        Tolkemetode: <span>{request.InterpretationMethodName__c}</span>
                    </p>
                    <p if:true={request.AssignmentType__c}>Anledning: <span>{request.AssignmentType__c}</span></p>
                    <br/>
                    <p if:true={request.CompanyName__c}>
                        Virksomhet: <span>{request.CompanyName__c}</span>
                    </p>
                    <p if:true={request.PaymentLiability__c}>
                        Betalingsansvar: <span>{request.PaymentLiability__c}</span>
                    </p>
                    <br if:true={request.Description__c}/>
                    <p if:true={request.Description__c}>Tilleggsopplysninger: <span>{request.Description__c}</span></p>
                </div>
                <c-record-files-with-sharing
                    if:true={isSeries}
                    record-id={request.Id}
                    is-get-all={isGetAllFiles}
                    is-delete-option="true"
                    title="Vedlegg"
                    delete-file-on-button-click="true"
                ></c-record-files-with-sharing>
                <br />
            </div>
            <div if:true={isWorkOrderDetails}>
                <div class="record-details-container">
                    <p>Fra dato: <span>{workOrderStartDate}</span></p>
                    <p>Til dato: <span>{workOrderEndDate}</span></p>
                    <br />
                    <p>Adresse: <span>{workOrder.HOT_AddressFormated__c}</span></p>
                    <p if:true={workOrderInterpretationAddressToShow}>
                        Oppmøteadresse: <span>{workOrderInterpretationAddressToShow}</span>
                    </p>
                    <br />
                    <p>Status: <span>{workOrder.HOT_ExternalWorkOrderStatus__c}</span></p>
                    <br />
                    <p if:true={request.OwnerName__c}>
                        Sentral: <span>{request.OwnerName__c}</span>
                    </p>
                    <p>Bestillingsnummer: <span>{workOrder.HOT_RequestName__c}</span></p>
                    <p if:true={request.OrdererName__c}>
                        Bestiller: <span>{request.OrdererName__c}</span>
                    </p>
                    <p if:true={request.UserName__c}>
                        Tolkebrukers navn: <span>{request.UserName__c}</span>
                    </p>
                    <p>SMS-varsel ved statusendring på bestillingen: <span>{isOrdererWantStatusUpdateOnSMS}</span></p>
                    <br/>
                    <p if:true={request.UserPreferredInterpreter__c}>
                        Ønsket tolk: <span>{request.UserPreferredInterpreter__c}</span>
                    </p>
                    <p if:true={workOrder.HOT_Interpreters__c}>
                        {interpreter}: <span>{workOrder.HOT_Interpreters__c}</span>
                    </p>
                    <p if:true={request.UserInterpretationMethod__c}>
                        Foretrukket tolkemetode: <span>{request.UserInterpretationMethod__c}</span>
                    </p>
                    <p if:true={request.InterpretationMethodName__c}>
                        Tolkemetode: <span>{request.InterpretationMethodName__c}</span>
                    </p>
                    <p if:true={request.AssignmentType__c}>Anledning: <span>{request.AssignmentType__c}</span></p>
                    <br/>
                    <p if:true={request.CompanyName__c}>
                        Virksomhet: <span>{request.CompanyName__c}</span>
                    </p>
                    <p if:true={request.PaymentLiability__c}>
                        Betalingsansvar: <span>{request.PaymentLiability__c}</span>
                    </p>
                    <br if:true={request.Description__c}/>
                    <p if:true={request.Description__c}>Tilleggsopplysninger: <span>{request.Description__c}</span></p>
                </div>
                <c-record-files-with-sharing
                    if:false={isSeries}
                    record-id={request.Id}
                    is-get-all={isGetAllFiles}
                    is-delete-option="true"
                    title="Vedlegg"
                    delete-file-on-button-click="true"
                ></c-record-files-with-sharing>
                <br />
            </div>
            
            <div class="buttonRow" if:true={isRequestOrWorkOrderDetails}>
                <c-button
                    button-label={editButtonLabel}
                    button-styling="primary"
                    style="padding-right: 1vw; padding-bottom: 1vw"
                    desktop-style="width: 8rem; justify-content: center"
                    mobile-style="width: 8rem; justify-content: center"
                    onbuttonclick={editOrder}
                    disabled={isRequestEditButtonDisabled}
                ></c-button>
                <c-button
                    button-label={copyButtonLabel}
                    button-styling="secondary"
                    style="padding-right: 1vw; padding-bottom: 1vw"
                    desktop-style="width: 8rem; justify-content: center"
                    mobile-style="width: 8rem; justify-content: center"
                    onbuttonclick={cloneOrder}
                ></c-button>
                <c-button
                    button-label={cancelButtonLabel}
                    button-styling="secondary"
                    style="padding-right: 1vw; padding-bottom: 1vw"
                    desktop-style="width: 8rem; justify-content: center"
                    mobile-style="width: 8rem; justify-content: center"
                    onbuttonclick={cancelOrder}
                    disabled={isRequestCancelButtonDisabled}
                ></c-button>
                <c-button
                    button-label="Legg til filer"
                    button-styling="primary"
                    style="padding-right: 1vw; padding-bottom: 1vw"
                    desktop-style="width: 8rem; justify-content: center"
                    mobile-style="width: 8rem; justify-content: center"
                    onbuttonclick={addFiles}
                    disabled={isRequestAddFilesButtonDisabled}
                ></c-button>
            </div>
            <div class="record-details-container" if:false={noWorkOrders}>
                <c-table
                    if:false={isWorkOrderDetails}
                    records={records}
                    columns={columns}
                    onrowclick={goToRecordDetails}
                    icon-by-value={iconByValue}
                ></c-table>
            </div>
            <div if:true={noWorkOrders} style="text-align: center">
                <br />
                Du har ingen bestillinger. Når du sender inn en ny bestilling vil den vises her.
            </div>
        </div>
    </main>
    <c-alertdialog
        header={modalHeader}
        content={modalContent}
        desktop-style="text-align: center; white-space: pre-line; width: 50%"
        mobile-style="text-align: center; white-space: pre-line; width: 100%"
        center-buttons="true"
        no-cancel-button={noCancelButton}
        onbuttonclick={handleAlertDialogClick}
    >
    </c-alertdialog>
    <div
        class="ReactModal__Overlay ReactModal__Overlay--after-open modal__overlay hidden"
        style="z-index: 9999; background-color: rgba(38, 38, 38, 0.7)"
        tabindex="-1"
    >
        <div
            class="ReactModal__Content ReactModal__Content--after-open comments-dialog-container"
            role="dialog"
            aria-labelledby="details-header-id"
        >
            <div class="loader hidden"></div>
            <div if:true={showUploadFilesComponent}>
                <h2 style="font-size: 1.25rem; text-align: center">Legg til filer i bestillingen</h2>
                <br />
                <lightning-file-upload
                label="Last opp fil"
                aria-label="Last opp fil"
                name="fileUploader"
                record-id={recordId}
                onuploadfinished={handleFileUpload}
                style="text-align: center;"
                multiple>
                </lightning-file-upload>
                <div class="checkboxClass hidden">
                    <c-checkbox
                        data-id="fileCheckbox"
                        label={checkboxContent}
                        oncheckboxclick={handleCheckboxValue}
                        error-text="Du må gi samtykke for å laste opp filer."
                    ></c-checkbox>
                </div>
                <div class="filesClass">
                    <ul aria-label="Liste over filer">
                        <template for:each={uploadedFiles} for:item="file" for:index="index">
                            <li key={file.name} class="fileAndButton">
                                <span key={file.name} class="typo-normal content fileNameClass">{file.name}</span>
                                <button
                                    onfocus={onFileFocus}
                                    aria-label={fileButtonLabel}
                                    data-index={index}
                                    key={file.name}
                                    type="button"
                                    value={file.name}
                                    class="navds-button"
                                    onclick={onFileDelete}
                                >
                                    Slett
                                </button>
                            </li>
                        </template>
                    </ul>
                </div>
            </div>
            <br />
            <br />
            <div style="text-align: center" aria-live="polite">
                <c-button
                    if:true={hasFiles}
                    button-styling="primary"
                    button-label="Lagre"
                    onbuttonclick={uploadFiles}
                    style="padding-right: 1vw"
                    desktop-style="width: 8rem; justify-content: center"
                    mobile-style="width: 8rem; justify-content: center"
                ></c-button>
                <c-button
                    if:true={showCancelUploadButton}
                    button-styling="secondary"
                    button-label="Avbryt"
                    onbuttonclick={cancelUploadFiles}
                    desktop-style="width: 8rem; justify-content: center"
                    mobile-style="width: 8rem; justify-content: center"
                ></c-button>
            </div>
        </div>
    </div>
</template>
