<template>
    <button class="open-filter-button" onclick={openFilters}>
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M14 3.49935H0V1.16602H14V3.49935ZM10.5 8.16601H3.5L3.5 5.83268L10.5 5.83268V8.16601ZM5.83333 12.8327H8.16667V10.4993H5.83333V12.8327Z"
                fill="#262626"
            ></path>
        </svg>
        <div style="margin-left: 0.5rem">
            <p>Filter</p>
        </div>
    </button>
    <div if:true={isOpen} class="fullscreen-overlay">
        <div class="overlay-container" draggable="true">
            <div class="overlay-content">
                <div class="drag-rectangle"></div>
                <h3 style="text-align: center; margin-bottom: 2rem">{header}</h3>
                <ul class="list">
                    <template iterator:it={filterArray}>
                        <li data-id={it.value.name} key={it.value.name} class="row-element" onclick={handleRowClick}>
                            <p class="filter-label">{it.value.label}</p>
                            <template iterator:element={it.value.value}>
                                <div
                                    if:true={element.value.isActive}
                                    key={element.value.name}
                                    class="active-filter-container"
                                >
                                    <p class="active-filter-text">{element.value.label}</p>
                                    <c-icon
                                        data-filter={it.value.name}
                                        data-id={element.value.name}
                                        onclick={removeFilter}
                                        icon="ErrorFilled"
                                    ></c-icon>
                                </div>
                            </template>
                            <c-icon if:false={it.value.isOpen} icon="Expand"></c-icon>
                            <c-icon if:true={it.value.isOpen} icon="Collapse"></c-icon>
                        </li>
                        <div if:true={it.value.isOpen} key={it.value.name} class="expanded-filter">
                            <c-checkboxgroup
                                if:true={it.value.isCheckboxgroup}
                                checkboxes={it.value.value}
                                oncheckboxgroupclick={handleCheckboxChange}
                                data-id={it.value.name}
                            ></c-checkboxgroup>
                            <fieldset if:true={it.value.isDateInterval}>
                                <template iterator:date={it.value.value}>
                                    <c-input
                                        key={date.value.name}
                                        label={date.value.label}
                                        data-id={date.value.name}
                                        type="date"
                                        ongetvalueonchange={handleDateChange}
                                        name={date.value.name}
                                        value={date.value.value}
                                    ></c-input>
                                </template>
                            </fieldset>
                        </div>
                    </template>
                </ul>
                <c-button button-label="Vis treff" button-styling="primary" onbuttonclick={applyFilter}></c-button>
            </div>
        </div>
    </div>
</template>
