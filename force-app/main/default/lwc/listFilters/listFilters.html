<template>
    <div if:true={isOpen} class="fullscreen-overlay">
        <div class="overlay-container" draggable="true">
            <div class="overlay-content">
                <div class="drag-rectangle"></div>
                <h3 style="text-align: center; margin-bottom: 2rem">{header}</h3>
                <ul class="list">
                    <template iterator:it={filterArray}>
                        <li
                            data-id={it.value.name}
                            key={it.value.name}
                            class="row-element"
                            onclick={handleRowClick}
                            data-filterindex={it.index}
                        >
                            <p class="filter-label">{it.value.label}</p>
                            <div class="active-filters-wrapper">
                                <template iterator:element={it.value.value}>
                                    <div
                                        if:true={element.value.value}
                                        key={element.value.name}
                                        class="active-filter-container"
                                    >
                                        <p class="active-filter-text">{element.value.label}</p>
                                        <c-icon
                                            data-filter={it.value.name}
                                            data-id={element.value.name}
                                            onclick={removeFilter}
                                            icon="ErrorFilled"
                                            data-filterindex={it.index}
                                            data-valueindex={element.index}
                                        ></c-icon>
                                    </div>
                                </template>
                            </div>
                            <c-icon if:false={it.value.isOpen} icon="Expand"></c-icon>
                            <c-icon if:true={it.value.isOpen} icon="Collapse"></c-icon>
                        </li>
                        <div if:true={it.value.isOpen} key={it.value.name} class="expanded-filter">
                            <c-checkboxgroup
                                if:true={it.value.isCheckboxgroup}
                                checkboxes={it.value.value}
                                oncheckboxgroupclick={handleCheckboxChange}
                                data-id={it.value.name}
                                data-filterindex={it.index}
                            ></c-checkboxgroup>
                            <fieldset if:true={it.value.isDateInterval}>
                                <template iterator:date={it.value.value}>
                                    <c-input
                                        key={date.value.name}
                                        label={date.value.label}
                                        data-id={date.value.name}
                                        type="date"
                                        ongetvalueonchange={handleDateChange}
                                        name={date.value.name}
                                        value={date.value.value}
                                        data-filterindex={it.index}
                                        data-valueindex={date.index}
                                    ></c-input>
                                </template>
                            </fieldset>
                        </div>
                    </template>
                </ul>
                <c-button button-label="Vis treff" button-styling="primary" onbuttonclick={applyFilter}></c-button>
            </div>
        </div>
    </div>
</template>
