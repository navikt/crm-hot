<template>
    <div class="brodsmulesti">
        <lightning-breadcrumbs class="liste-max-width">
            <lightning-breadcrumb label="Tolketjenesten" href="/s/"> </lightning-breadcrumb>
            <lightning-breadcrumb label="Mine bestillinger" href="/s/mine-bestillinger"> </lightning-breadcrumb>
        </lightning-breadcrumbs>
    </div>

    <div class="liste liste-max-width">
        <div class="action-container">
            <div class="left-content">
                <lightning-radio-group
                    label="Type bestilling"
                    class="horizontal"
                    name="radioGroup"
                    options={requestTypes}
                    value="my"
                    type="radio"
                    onchange={handleRequestType}
                ></lightning-radio-group>
                <br />
                <c-picklist
                    master-label="Filtrer på status"
                    choices={choices}
                    onpicklistvaluechange={handlePicklist}
                ></c-picklist>
            </div>
            <div class="right-content">
                <lightning-button title="Ny bestilling" variant="brand" label="Ny bestilling" onclick={goToNewRequest}>
                </lightning-button>
            </div>
        </div>
        <div class="mobile-only" style="margin-bottom: 0.5rem; width: 100%">
            <c-picklist
                master-label="Sorter etter"
                choices={sortingOptions}
                onpicklistvaluechange={onHandleSort}
            ></c-picklist>
        </div>
        <p style="align-self: flex-start" class="typo-normal">
            Merk: For serieoppdrag vises start- og sluttid for den første forekomsten. For å se alle tidene under en
            bestilling, inkludert status og tildelt tolk, kan du velge Se tidsplan i menyen til høyre på raden.
        </p>

        <br />
        <lightning-datatable
            key-field="Id"
            data={requests}
            columns={columns}
            hide-checkbox-column="true"
            default-sort-direction={defaultSortDirection}
            sorted-direction={sortDirection}
            sorted-by={sortedBy}
            onsort={onHandleSort}
            onrowaction={handleRowAction}
        >
        </lightning-datatable>
    </div>

    <div
        class="ReactModal__Overlay ReactModal__Overlay--after-open modal__overlay hidden"
        style="z-index: 9999; background-color: rgba(38, 38, 38, 0.7)"
        tabindex="-1"
    >
        <div
            class="ReactModal__Content ReactModal__Content--after-open navno-dekorator comments-dialog-container"
            role="dialog"
            aria-labelledby="details-header-id"
        >
            <div class="skjema skjema-max-width">
                <h2 id="details-header-id" class="typo-undertittel">Detaljer</h2>
                <section if:true={userForm} class="bruker-info-skjema sub-form">
                    <h2 style="font-size: 1.25rem">Informasjon om bruker</h2>
                    <c-hot_record-details record={userFields}></c-hot_record-details>
                </section>

                <section class="bestiller-info-skjema sub-form">
                    <h2 style="font-size: 1.25rem">Informasjon om bestiller</h2>
                    <c-hot_record-details record={ordererFields}></c-hot_record-details>
                </section>

                <section if:true={companyForm} class="virksomhet-info-skjema sub-form">
                    <h2 style="font-size: 1.25rem">Informasjon om virksomhet</h2>
                    <c-hot_record-details record={companyFields}></c-hot_record-details>
                </section>

                <section class="bestilling-info-skjema sub-form">
                    <h2 style="font-size: 1.25rem">Informasjon om tolkebehov</h2>
                    <c-hot_record-details record={requestFields}></c-hot_record-details>
                    <c-record-files-without-sharing
                        record-id={recordId}
                        is-get-all={isGetAllFiles}
                    ></c-record-files-without-sharing>
                </section>
            </div>
            <div class="loader hidden"></div>
            <div if:true={showUploadFilesComponent}>
                <h2 style="font-size: 1.25rem; text-align: center">Legg til filer i bestillingen</h2>
                <br />
                <c-upload-files
                    record-id={recordId}
                    onfiledatalength={checkFileDataLength}
                    onuploadcomplete={onUploadComplete}
                    onuploaderror={onUploadError}
                    ongetcheckboxvalue={getCheckboxValue}
                    checkbox-validation="true"
                    checkbox-text-plural="Dokumentene som er lagt ved gir mer informasjon om denne bestillingen. Jeg er klar over at vedlegget vil bli delt med tolken(e) jeg får."
                    checkbox-text-single="Dokumentet som er lagt ved gir mer informasjon om denne bestillingen. Jeg er klar over at vedlegget vil bli delt med tolken(e) jeg får."
                    validation-message="For å legge til vedlegg må du gi samtykke til at formidler og tolk kan se vedleggene som lastes opp"
                ></c-upload-files>
            </div>

            <br />
            <div if:true={hasFiles} style="text-align: center" aria-live="polite">
                <c-button button-styling="primary" button-label="Lagre" onbuttonclick={uploadFilesOnSave}></c-button>
            </div>
            <button class="lukknapp lukknapp--overstHjorne modal__lukkknapp--shake" onclick={abortShowDetails}>
                <span class="text-hide">Lukk</span>
            </button>
        </div>
    </div>

    <c-alertdialog
        header={header}
        content={content}
        desktop-style="text-align: center; max-width: 30%"
        center-buttons="true"
        no-cancel-button="true"
        mobile-style="text-align: center; max-width: fit-content"
    ></c-alertdialog>
</template>
